Hostname "{{ inventory_hostname }}"

FQDNLookup false
Interval {{ collect_interval }}
Timeout 2
ReadThreads 5

LoadPlugin cpu
LoadPlugin df
LoadPlugin load
LoadPlugin memory
LoadPlugin disk
LoadPlugin interface
LoadPlugin uptime
LoadPlugin swap
LoadPlugin write_graphite
LoadPlugin conntrack
LoadPlugin fscache
LoadPlugin contextswitch
LoadPlugin tcpconns
LoadPlugin processes
LoadPlugin cgroups

<Plugin cpu>
  ReportByCpu {{ report_by_cpu }}
</Plugin>

<Plugin df>
  # expose host's mounts into container using -v /:/host:ro  (location inside container does not matter much)
  # ignore rootfs; else, the root file-system would appear twice, causing
  # one of the updates to fail and spam the log
  FSType rootfs
  # ignore the usual virtual / temporary file-systems
  FSType sysfs
  FSType proc
  FSType devtmpfs
  FSType devpts
  FSType tmpfs
  FSType fusectl
  FSType cgroup
  FSType overlay
  FSType debugfs
  FSType pstore
  FSType securityfs
  FSType hugetlbfs
  FSType squashfs
  FSType mqueue
  MountPoint "/etc/resolv.conf"
  MountPoint "/etc/hostname"
  MountPoint "/etc/hosts"
  IgnoreSelected true
  ReportByDevice false
  ReportReserved true
  ReportInodes true
  ValuesAbsolute true
  ValuesPercentage true
</Plugin>

<Plugin memory>
  ValuesAbsolute true
  ValuesPercentage true
</Plugin>

<Plugin "disk">
  Disk "/^[hs]d[a-z]/"
  IgnoreSelected false
</Plugin>


<Plugin interface>
  Interface "lo"
  Interface "/^veth.*/"
  Interface "/^docker.*/"
  IgnoreSelected true
</Plugin>

<Plugin "tcpconns">
  ListeningPorts false
  LocalPort "{{ kafka_port }}"
  LocalPort "{{ kafka_http_proxy_port }}"
  LocalPort "{{ elasticsearch_http_port }}"
  LocalPort "{{ elasticsearch_transport_port }}"
  LocalPort "{{ zookeeper_client_port }}"
</Plugin>


<Plugin "write_graphite">
 <Carbon>
   Host "{{ net_graphite_host }}"
   Port "{{ graphite_port }}"
   Prefix "{{ graphite_prefix }}"
   EscapeCharacter "_"
   SeparateInstances true
   StoreRates true
   AlwaysAppendDS false
 </Carbon>
</Plugin>
